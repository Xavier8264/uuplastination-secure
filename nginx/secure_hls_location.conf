# HLS playlist/segment delivery for dashboard under both root and /secure/
# Adjust 'root' or 'alias' to point at the directory where cam.m3u8 and .ts segments are written.
# Example directory: /var/www/hls (ensure files: cam.m3u8, cam0.ts, ...)

# Root path (e.g. https://uuplastination.com/live/cam.m3u8)
location ^~ /live/ {
    # If using a local directory holding HLS output:
    # root /var/www;               # serves /var/www/live/cam.m3u8
    # OR if your segments are in /var/www/hls then use alias:
    alias /var/www/hls/;           # cam.m3u8 becomes /live/cam.m3u8
    add_header Cache-Control no-cache;
    types { application/vnd.apple.mpegurl m3u8; video/MP2T ts; }
    # CORS (optional)
    add_header Access-Control-Allow-Origin *;
}

# Secure path (e.g. https://uuplastination.com/secure/live/cam.m3u8)
location ^~ /secure/live/ {
    alias /var/www/hls/;           # same directory
    add_header Cache-Control no-cache;
    types { application/vnd.apple.mpegurl m3u8; video/MP2T ts; }
    add_header Access-Control-Allow-Origin *;
}

# If you publish HLS via a container volume instead, adjust alias above to that mount.
# Reload nginx after adding: sudo nginx -t && sudo systemctl reload nginx
